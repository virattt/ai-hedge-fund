# AI Hedge Fund - Comprehensive Codebase Analysis & Setup Guide

*Generated by Claude Code - Dr. Cayman Seagraves*

## 📋 Executive Summary

This is a sophisticated AI-powered hedge fund system that uses multiple agent personalities (famous investors like Warren Buffett, Charlie Munger, etc.) to make trading decisions. The system combines a Python-based CLI tool with a full-stack web application, all containerized with Docker for easy deployment.

**🚨 CRITICAL SETUP REQUIREMENTS:**
- **Poetry installation required** (not currently installed)
- **Virtual environment strongly recommended**
- **Multiple API keys needed** for full functionality
- **Environment configuration essential**

---

## 🏗️ Project Architecture Overview

### Core Components Structure

```
ai-hedge-fund/
├── src/                    # Core Python CLI application
│   ├── agents/            # 18+ investment agent personalities
│   ├── graph/             # LangGraph workflow orchestration
│   ├── llm/               # Multi-provider LLM integrations
│   ├── tools/             # Financial data fetching utilities
│   ├── utils/             # Common utilities
│   ├── main.py            # CLI entry point
│   └── backtester.py      # Backtesting framework
├── app/                   # Full-stack web application
│   ├── backend/           # FastAPI REST API server
│   ├── frontend/          # React/Vite TypeScript UI
│   └── run.sh|.bat        # Quick start scripts
├── docker/                # Containerization setup
│   ├── docker-compose.yml # Multi-service orchestration
│   └── Dockerfile         # Python environment
├── tests/                 # Test suite (limited coverage)
├── pyproject.toml         # Python dependencies
└── .env                   # Environment configuration
```

### Agent System Architecture

**Investment Personalities (12 agents):**
- Warren Buffett, Charlie Munger, Peter Lynch, Bill Ackman, etc.

**Analysis Agents (4 types):**
- Valuation, Sentiment, Fundamentals, Technicals

**Decision Agents (2 types):**
- Risk Manager, Portfolio Manager

**Orchestration:**
- LangGraph state management
- Multi-provider LLM support (OpenAI, Anthropic, Groq, etc.)

---

## 🔧 Current System Analysis

### ✅ Available Tools
- **Python 3.13.5** (✓ Compatible with ^3.11 requirement)
- **pip 25.2** (✓ Package installer available)
- **Node.js v24.4.1** (✓ Modern version)
- **npm v11.4.2** (✓ Package manager)
- **pnpm v10.14.0** (✓ Preferred frontend package manager)
- **Python venv module** (✓ Virtual environment support)

### ❌ Missing Critical Dependencies
- **Poetry** (❌ Not installed - REQUIRED for dependency management)
- **Environment setup** (❌ .env needs configuration)

### 📦 Dependency Management Analysis

**Python Dependencies (pyproject.toml):**
- 30+ dependencies including LangChain, FastAPI, pandas, numpy
- Multiple LLM provider integrations
- Development tools: black, isort, flake8, pytest
- Poetry lock file present (409KB) - indicates complex dependency tree

**Frontend Dependencies (package.json):**
- React 18 with TypeScript
- Modern UI stack: Radix UI, Tailwind CSS, shadcn/ui
- Build tools: Vite, ESLint, TypeScript
- Visualization: ReactFlow for agent workflow diagrams
- Package managers: Both npm (package-lock.json) and pnpm (pnpm-lock.yaml)

---

## 🚀 Optimal Setup Strategy

### Step 1: Install Poetry (Required)

**Windows:**
```powershell
# Option 1: Official installer (Recommended)
(Invoke-WebRequest -Uri https://install.python-poetry.org -UseBasicParsing).Content | python -

# Option 2: Via pip (Alternative)
pip install poetry==1.7.1
```

**Verify installation:**
```bash
poetry --version
# Should output: Poetry (version 1.7.1)
```

### Step 2: Create Virtual Environment (Strongly Recommended)

```bash
# Create virtual environment
python -m venv hedge-fund-env

# Activate virtual environment
# Windows:
hedge-fund-env\Scripts\activate
# macOS/Linux:
source hedge-fund-env/bin/activate

# Verify activation (should show virtual environment name in prompt)
```

### Step 3: Install Python Dependencies

```bash
# Install all dependencies with Poetry
poetry install

# Verify installation
poetry check
poetry show --tree
```

### Step 4: Environment Configuration

```bash
# Copy example environment file
cp .env.example .env

# Edit .env with your API keys:
# - OPENAI_API_KEY (required for most functionality)
# - FINANCIAL_DATASETS_API_KEY (optional, some stocks work without it)
# - Additional LLM provider keys (optional)
```

### Step 5: Frontend Setup

```bash
cd app/frontend

# Install dependencies with pnpm (preferred)
pnpm install

# Alternative: use npm if pnpm issues occur
npm install
```

---

## 🏃‍♂️ Running the Application

### Option 1: Quick Web App Launch (Recommended for Beginners)
```bash
# From app/ directory
./run.sh        # macOS/Linux
run.bat         # Windows

# This automatically handles backend and frontend setup
```

### Option 2: CLI Usage (Advanced Users)
```bash
# Basic hedge fund analysis
poetry run python src/main.py --ticker AAPL,MSFT,NVDA

# With local Ollama models
poetry run python src/main.py --ticker AAPL --ollama

# Backtesting
poetry run python src/backtester.py --ticker AAPL,MSFT,NVDA

# With date range
poetry run python src/main.py --ticker AAPL --start-date 2024-01-01 --end-date 2024-03-01
```

### Option 3: Docker (Containerized)
```bash
# Full containerized setup
cd docker/
docker-compose up --build

# Specific services
docker-compose up hedge-fund
docker-compose up backtester-ollama
```

---

## 🔧 Development Workflow

### Code Formatting & Linting
```bash
# Python formatting (black with 420 char line length)
poetry run black src/ tests/ --line-length 420
poetry run isort src/ tests/ --profile black
poetry run flake8 src/ tests/

# Frontend linting
cd app/frontend
pnpm lint        # or npm run lint
```

### Testing
```bash
# Python tests (limited coverage currently)
poetry run pytest tests/

# Frontend build test
cd app/frontend
pnpm build       # or npm run build
```

---

## 📁 Directory Deep Dive

### `src/agents/` (18 files)
Individual agent implementations with distinct investment philosophies:
- **Legendary Investors:** warren_buffett.py, charlie_munger.py, peter_lynch.py
- **Analysis Specialists:** fundamentals.py, valuation.py, sentiment.py, technicals.py
- **Risk Management:** risk_manager.py, portfolio_manager.py

### `src/llm/` 
Multi-provider LLM integration:
- **models.py:** Provider configurations (11,118 lines)
- **api_models.json:** External model definitions
- **ollama_models.json:** Local model configurations

### `app/backend/`
FastAPI application:
- **main.py:** Server entry point
- **models/:** Database models
- **routes/:** REST API endpoints
- **services/:** Business logic layer
- **alembic/:** Database migrations

### `app/frontend/src/`
Modern React application:
- **components/:** UI components (shadcn/ui based)
- **nodes/ & edges/:** ReactFlow custom components
- **services/:** API integration layer
- **contexts/:** React state management

---

## 🚨 Critical Path Issues & Solutions

### Issue 1: Poetry Not Installed
**Problem:** Core dependency manager missing
**Solution:** Install Poetry via official installer or pip
**Impact:** Cannot install Python dependencies without this

### Issue 2: Virtual Environment Not Set Up
**Problem:** Global Python installation conflicts
**Solution:** Create dedicated virtual environment
**Impact:** Dependency conflicts, version mismatches

### Issue 3: API Keys Configuration
**Problem:** External services require authentication
**Solution:** Configure .env with required API keys
**Impact:** Limited functionality, possible runtime errors

### Issue 4: Package Manager Choice (Frontend)
**Problem:** Both npm and pnpm lock files present
**Solution:** Use pnpm (preferred, faster, more efficient)
**Impact:** Inconsistent dependency resolution

---

## ⚡ Performance & Optimization Recommendations

### Python Environment
1. **Use Poetry with virtual environment** (isolated dependencies)
2. **Pin Poetry version to 1.7.1** (matches Docker configuration)
3. **Enable Poetry shell activation** for easier development

### Frontend Development
1. **Use pnpm instead of npm** (faster installs, better caching)
2. **Leverage Vite's hot reload** for development
3. **Build optimization** via Vite's tree-shaking

### Docker Strategy
1. **Use Docker for production-like testing**
2. **Leverage multi-stage builds** for optimization
3. **Local development** should use native tools for speed

---

## 🔐 Security & Configuration Notes

### Environment Variables (.env)
- **Never commit .env to version control** (already in .gitignore)
- **Use .env.example as template**
- **Required vs Optional keys clearly documented**

### API Key Management
- **OPENAI_API_KEY:** Required for most functionality
- **FINANCIAL_DATASETS_API_KEY:** Optional (free tier available)
- **Other LLM providers:** Optional but expand capabilities

### Development vs Production
- **Development:** Use local virtual environment
- **Production:** Use Docker containers
- **Testing:** Both approaches supported

---

## 📈 Next Steps & Recommendations

### Immediate Actions (Required)
1. **Install Poetry** (`pip install poetry==1.7.1`)
2. **Create virtual environment** (`python -m venv hedge-fund-env`)
3. **Activate environment and install dependencies** (`poetry install`)
4. **Configure .env file** with at least OpenAI API key
5. **Test basic functionality** (`poetry run python src/main.py --ticker AAPL`)

### Optional Enhancements
1. **Set up Ollama** for local model usage
2. **Configure additional LLM providers** for redundancy
3. **Explore backtesting capabilities**
4. **Run web application** for visual interface

### Long-term Development
1. **Expand test coverage** (currently minimal)
2. **Add custom agent personalities**
3. **Implement additional financial data sources**
4. **Enhance web UI with more visualizations**

---

## 🤝 Support & Troubleshooting

### Common Issues

**Poetry installation fails:**
- Try the official installer method
- Ensure Python is in PATH
- Consider using pip fallback method

**Virtual environment activation issues:**
- Verify correct activation script path
- Check Python version compatibility
- Try recreating environment if corrupted

**API key errors:**
- Verify .env file location and format
- Check API key validity with provider
- Ensure no trailing spaces in keys

**Frontend build failures:**
- Try clearing node_modules and reinstalling
- Use pnpm instead of npm
- Check Node.js version compatibility

### Getting Help
- **Documentation:** Extensive CLAUDE.md files in each directory
- **Shell scripts:** Automated setup in `app/run.sh` and `app/run.bat`
- **Docker:** Fallback containerized environment available

---

**Document Generated:** $(date)
**System Analyzed:** Windows with Python 3.13.5, Node.js v24.4.1, pnpm v10.14.0
**Poetry Status:** Not installed (requires setup)
**Recommendation:** Follow Step 1-4 for optimal development setup